'use strict';

// --- 1. 经典方式：构造函数与原型 (ES5及之前) ---
console.log('--- 1. 使用原型继承 ---');

// a. 定义一个“父类”：Person
function Person(name, age) {
    // 构造函数：负责初始化实例自身的属性
    // 这些属性是每个实例独有的
    this.name = name;
    this.age = age;
}

// 在 Person 的原型(prototype)上定义共享的方法
// 所有 Person 的实例都可以访问这个方法，且内存中只有一份
Person.prototype.sayHello = function() {
    console.log(`大家好，我是${this.name}，今年${this.age}岁。`);
};

// b. 定义一个“子类”：Student，并实现继承
function Student(name, age, major) {
    // “借用”父类的构造函数来初始化继承来的属性
    // 使用 .call(this, ...) 来确保父类构造函数里的 this 指向 Student 的实例
    Person.call(this, name, age);

    // 添加子类自己独有的属性
    this.major = major;
    this.getmajor = () => {return this.major};
}

// c. 链接原型链 (继承共享方法的关键步骤)
// 创建一个临时的空对象，其原型指向父类的原型
// 然后让子类的原型指向这个空对象
Student.prototype = Object.create(Person.prototype);
// 修复子类原型的 constructor 指针，让它指回 Student 自身
Student.prototype.constructor = Student;

// d. 在子类的原型上添加新方法
Student.prototype.study = function() {
    console.log(`我正在学习${this.major}专业。`);
};

// e. 创建实例并测试
const personInstance = new Person('老王', 40);
const studentInstance = new Student('小明', 21, '电子信息工程');

personInstance.sayHello();
studentInstance.sayHello(); // 成功调用了从 Person 继承来的方法
studentInstance.study();    // 成功调用了自己独有的方法


// --- 2. 现代方式：Class 语法糖 (ES6及之后) ---
console.log('\n--- 2. 使用Class语法 ---');

// a. 定义一个“父类”：Animal
class Animal {
    // constructor 就是构造函数
    constructor(name) {
        this.name = name;
    }

    // 在class中直接定义方法，它们会自动被添加到原型上
    speak() {
        console.log(`${this.name} 发出了一些声音。`);
    }
}

// b. 使用 `extends` 关键字实现继承
class Cat extends Animal {
    constructor(name, action) {
        // `super(name)` 调用父类的构造函数，必须在第一行
        super(name);
        this.action = action;
    }

    // 重写(Override)父类的方法
    speak() {
        console.log(`${this.name} 喵喵叫。`);
    }

    // 添加子类自己的方法
    purr() {
        console.log(`${this.name} 正在 ${this.action}。`);
    }
}

// c. 创建实例并测试
const genericAnimal = new Animal('某种动物');
const kitty = new Cat('咪咪', '咕噜咕噜');

genericAnimal.speak(); // 输出: 某种动物 发出了一些声音。
kitty.speak();         // 输出: 咪咪 喵喵叫。(子类重写的方法生效了)
kitty.purr();          // 输出: 咪咪 正在 咕噜咕噜。

// 验证继承关系
console.log(kitty instanceof Cat);    // true
console.log(kitty instanceof Animal); // true，证明继承链是成功的